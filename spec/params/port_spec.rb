require 'spec_helper'
require 'ronin/exploits/params/port'
require 'ronin/exploits/exploit'

describe Ronin::Exploits::Params::Port do
  module TestPortParam
    class TestExploit < Ronin::Exploits::Exploit
      include Ronin::Exploits::Params::Port
    end
  end

  describe ".included" do
    subject { TestPortParam::TestExploit }

    it "must add a required 'port' param to the exploit class" do
      expect(subject.params[:port]).to_not be_nil
      expect(subject.params[:port].required?).to be(true)
      expect(subject.params[:port].desc).to eq("Remote port to connect to")
    end
  end
end
