# encoding: US-ASCII

require 'spec_helper'
require 'ronin/exploits/local'
require 'ronin/exploits/helpers/format_string'

describe Exploits::Helpers::FormatString do
  subject do
    Exploits::Local.object do
      helper :format_string

      targeting do |t|
        t.targets_arch   :x86
        t.pop_length   = 256
        t.overwrite    = 0xffffaaaa
        t.address      = 0xffffbbbb
      end

      build { @format_string = build_format_string }
    end
  end

  it "should build a format string" do
    subject.target = subject.targets[0]
    subject.build!

    subject.format_string.should_not be_nil
  end
end
