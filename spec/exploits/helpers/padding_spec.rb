require 'spec_helper'
require 'ronin/exploits/local'
require 'ronin/exploits/helpers/padding'

describe Exploits::Helpers::Padding do
  subject do
    Exploits::Local.object do
      helper :padding

      def pad_buffer
        pad(1024)
      end

      def pad_data_left
        pad_left('hello',1024)
      end

      def pad_data_right
        pad_right('hello',1024)
      end
    end
  end

  it "should pad a buffer" do
    buffer = subject.pad_buffer

    expect(buffer.length).to eq(1024)
  end

  it "should pad a buffer with data to the left" do
    buffer = subject.pad_data_left

    expect(buffer.length).to eq(1024)
    expect(buffer =~ /hello$/).not_to be_nil
  end

  it "should pad a buffer with data to the right" do
    buffer = subject.pad_data_right

    expect(buffer.length).to eq(1024)
    expect(buffer =~ /^hello/).not_to be_nil
  end
end
