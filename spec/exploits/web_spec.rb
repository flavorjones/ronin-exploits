require 'spec_helper'
require 'ronin/exploits/web'

describe Exploits::Web do
  it "should initialize all parameters by default" do
    subject.params.should_not be_empty
  end

  describe "#url" do
    let(:exploit) do
      described_class.new(
        :host             => 'example.com',
        :url_path         => '/path',
        :url_query        => 'q=1',
        :url_query_params => {'x' => '1', 'y' => '1'}
      )
    end

    subject { exploit.url }

    it "should use the url_path property" do
      subject.path.should == exploit.url_path
    end

    it "should use the url_query property" do
      subject.query.should include(exploit.url_query)
    end

    it "should include the url_query_params parameter" do
      subject.query_params['x'].should == exploit.url_query_params['x']
      subject.query_params['y'].should == exploit.url_query_params['y']
    end
  end
end
