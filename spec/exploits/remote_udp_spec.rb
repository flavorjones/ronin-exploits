require 'spec_helper'
require 'ronin/exploits/remote_udp'

describe Exploits::RemoteUDP do
  subject do
    described_class.new(
      :default_port => 22,
      :host => '127.0.0.1'
    )
  end

  it "should include the UDP Network helper module" do
    expect(described_class).to be < Network::Mixins::UDP
  end

  it "should initialize all parameters by default" do
    expect(subject.params).not_to be_empty
  end

  describe "#port" do
    before { subject.build! }

    it "should default the port to the default_port before deploying" do
      subject.deploy! { |e| expect(e.port).to eq(e.default_port) }
    end
  end
end
