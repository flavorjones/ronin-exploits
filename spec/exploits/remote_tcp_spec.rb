require 'spec_helper'
require 'ronin/exploits/remote_tcp'

describe Exploits::RemoteTCP do
  subject do
    described_class.new(
      default_port: 22,
      host: '127.0.0.1'
    )
  end

  it "should include the TCP Network helper module" do
    described_class.should < Network::Mixins::TCP
  end

  it "should initialize all parameters by default" do
    subject.params.should_not be_empty
  end

  describe "#port" do
    before { subject.build! }

    it "should default to the default_port before deploying" do
      subject.deploy! { |e| e.port.should == e.default_port }
    end
  end
end
