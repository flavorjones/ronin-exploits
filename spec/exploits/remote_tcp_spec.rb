require 'spec_helper'
require 'ronin/exploits/remote_tcp'

describe Exploits::RemoteTCP do
  subject do
    described_class.new(
      default_port: 22,
      host: '127.0.0.1'
    )
  end

  it "should include the TCP Network helper module" do
    expect(described_class).to be < Network::Mixins::TCP
  end

  it "should initialize all parameters by default" do
    expect(subject.params).not_to be_empty
  end

  describe "#port" do
    before { subject.build! }

    it "should default to the default_port before deploying" do
      subject.deploy! { |e| expect(e.port).to eq(e.default_port) }
    end
  end
end
