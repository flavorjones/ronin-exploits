require 'spec_helper'
require 'ronin/model/has_default_port'

require 'model/models/default_port_model'
require 'model/models/non_default_port_model'

describe Model::HasDefaultPort do
  subject { DefaultPortModel }

  it "should define a default_port property" do
    expect(subject.properties).to be_named(:default_port)
  end

  it "should initialize the default_port property if DEFAULT_PORT is defined" do
    resource = subject.new

    expect(resource.default_port).to eq(DefaultPortModel::DEFAULT_PORT)
  end

  it "should not initialize the default_port property if DEFAULT_PORT is undefined" do
    resource = NonDefaultPortModel.new

    expect(resource.default_port).to be_nil
  end

  it "should allow default_port to be overridden" do
    resource = subject.new(default_port: 70)

    expect(resource.default_port).to eq(70)
  end
end
