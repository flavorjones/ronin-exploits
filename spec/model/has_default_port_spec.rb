require 'spec_helper'
require 'ronin/model/has_default_port'

require 'model/models/default_port_model'
require 'model/models/non_default_port_model'

describe Model::HasDefaultPort do
  subject { DefaultPortModel }

  it "should define a default_port property" do
    subject.properties.should be_named(:default_port)
  end

  it "should initialize the default_port property if DEFAULT_PORT is defined" do
    resource = subject.new

    resource.default_port.should == DefaultPortModel::DEFAULT_PORT
  end

  it "should not initialize the default_port property if DEFAULT_PORT is undefined" do
    resource = NonDefaultPortModel.new

    resource.default_port.should be_nil
  end

  it "should allow default_port to be overridden" do
    resource = subject.new(default_port: 70)

    resource.default_port.should == 70
  end
end
