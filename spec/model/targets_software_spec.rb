require 'spec_helper'
require 'ronin/model/targets_software'

require 'model/models/targets_software_model'

describe Model::TargetsSoftware do
  subject { TargetsSoftwareModel }

  it "should define a software relation" do
    relationship = subject.relationships['software']

    relationship.should_not be_nil
    relationship.parent_model.should == Software
  end

  it "should define a relationship with Software" do
    relationship = Software.relationships['targets_software_models']

    relationship.should_not be_nil
    relationship.child_model.should == subject
  end

  it "should allow the software to be set via the getter method" do
    resource = subject.new
    resource.targets_software 'Toaster', '1.2.3'

    resource.software.name.should == 'Toaster'
    resource.software.version.should == '1.2.3'
  end
end
