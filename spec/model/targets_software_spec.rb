require 'spec_helper'
require 'ronin/model/targets_software'

require 'model/models/targets_software_model'

describe Model::TargetsSoftware do
  subject { TargetsSoftwareModel }

  it "should define a software relation" do
    relationship = subject.relationships['software']

    expect(relationship).not_to be_nil
    expect(relationship.parent_model).to eq(Software)
  end

  it "should define a relationship with Software" do
    relationship = Software.relationships['targets_software_models']

    expect(relationship).not_to be_nil
    expect(relationship.child_model).to eq(subject)
  end

  it "should allow the software to be set via the getter method" do
    resource = subject.new
    resource.targets_software 'Toaster', '1.2.3'

    expect(resource.software.name).to eq('Toaster')
    expect(resource.software.version).to eq('1.2.3')
  end
end
