require 'spec_helper'
require 'ronin/model/targets_os'

require 'model/models/targets_os_model'

describe Model::TargetsOS do
  subject { TargetsOSModel }

  it "should define an os relation" do
    relationship = subject.relationships['os']

    expect(relationship).not_to be_nil
    expect(relationship.parent_model).to eq(OS)
  end

  it "should define a relationship with Arch" do
    relationship = OS.relationships['targets_os_models']

    expect(relationship).not_to be_nil
    expect(relationship.child_model).to eq(subject)
  end

  it "should allow the os to be set via the getter method" do
    resource = subject.new
    resource.targets_os 'Linux', '2.6.29'

    expect(resource.os.name).to eq('Linux')
    expect(resource.os.version).to eq('2.6.29')
  end
end
