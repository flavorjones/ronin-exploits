require 'spec_helper'
require 'ronin/model/targets_os'

require 'model/models/targets_os_model'

describe Model::TargetsOS do
  subject { TargetsOSModel }

  it "should define an os relation" do
    relationship = subject.relationships['os']

    relationship.should_not be_nil
    relationship.parent_model.should == OS
  end

  it "should define a relationship with Arch" do
    relationship = OS.relationships['targets_os_models']

    relationship.should_not be_nil
    relationship.child_model.should == subject
  end

  it "should allow the os to be set via the getter method" do
    resource = subject.new
    resource.targets_os 'Linux', '2.6.29'

    resource.os.name.should == 'Linux'
    resource.os.version.should == '2.6.29'
  end
end
