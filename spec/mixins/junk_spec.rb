require 'spec_helper'
require 'ronin/exploits/mixins/junk'

require 'ronin/exploits/exploit'

describe Ronin::Exploits::Mixins::Junk do
  module TestJunkMixin
    class TestExploit < Ronin::Exploits::Exploit
      include Ronin::Exploits::Mixins::Junk
    end
  end

  let(:exploit_class) { TestJunkMixin::TestExploit }

  subject { exploit_class.new }

  describe "#junk" do
    let(:count) { 1024 }

    it "must return a String of 'A' characters for the given count" do
      expect(subject.junk(count)).to eq('A' * count)
    end

    context "when given a custom character" do
      let(:char) { 'B' }

      it "must return a String of the given characters for the given count" do
        expect(subject.junk(char,count)).to eq(char * count)
      end
    end

    context "when given a custom String" do
      let(:string) { 'AB' }

      it "must return a String of the given String repeated for the given count" do
        expect(subject.junk(string,count)).to eq(string * count)
      end
    end
  end
end
